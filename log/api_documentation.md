# üìë –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API (v2.0)

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å —Ä–æ–ª—è–º–∏ (RBAC) –∏ JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π.

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–í—Å—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ **JWT-—Ç–æ–∫–µ–Ω–æ–≤**. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ —Ç–æ–∫–µ–Ω–æ–≤:

1.  **–¢–æ–∫–µ–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:** –í—ã–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ `POST /app/auth/login`. –°–æ–¥–µ—Ä–∂–∏—Ç `userId` –∏ `role`.
2.  **–ì–æ—Å—Ç–µ–≤–æ–π —Ç–æ–∫–µ–Ω:** –í—ã–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è QR-–∫–æ–¥–∞ —á–µ—Ä–µ–∑ `GET /web/status/{tableId}`. –°–æ–¥–µ—Ä–∂–∏—Ç `tableId`, `restaurantId` –∏ —Ä–æ–ª—å `CUSTOMER`.

**–ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
- –õ—é–±–æ–π –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Authorization: Bearer <token>`.
- –ë—ç–∫–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (`permissions`) –¥–ª—è —Ä–æ–ª–∏, —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤ —Ç–æ–∫–µ–Ω–µ.
- WebSocket-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–∫–∂–µ —Ç—Ä–µ–±—É–µ—Ç —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏.

---

## üè¢ API –¥–ª—è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ü–µ—Ä—Å–æ–Ω–∞–ª–∞

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/app`, `/users`)

- **`POST /app/auth/login`**
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–æ—Ñ–∏—Ü–∏–∞–Ω—Ç, –ø–æ–≤–∞—Ä, –∞–¥–º–∏–Ω).
  - **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON):** `{ "login": "string", "password": "string", "restaurantId": "string" }`
  - **–û—Ç–≤–µ—Ç (200 OK):** `{ "token": "string" }`
  - **–ó–∞—â–∏—Ç–∞:** –ü—É–±–ª–∏—á–Ω—ã–π.

- **`POST /users`**
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–æ—Ñ–∏—Ü–∏–∞–Ω—Ç–∞ –∏–ª–∏ –ø–æ–≤–∞—Ä–∞). –¢—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤ `user:create`.
  - **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON):** `{ "login": "string", "password": "string", "name": "string", "role": "WAITER" | "CHEF", "restaurantId": "string" }`
  - **–û—Ç–≤–µ—Ç (201 Created):** –£—Å–ø–µ—Ö (–ø—É—Å—Ç–æ–µ —Ç–µ–ª–æ).
  - **–û—Ç–≤–µ—Ç (403 Forbidden):** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –∏–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ.
  - **–ó–∞—â–∏—Ç–∞:** –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞).

###  WebSocket (Real-time)

- **`WS /updates`**
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ WebSocket-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.
  - **–ü—Ä–æ—Ç–æ–∫–æ–ª:** `ws://` –∏–ª–∏ `wss://`.
  - **–ó–∞–≥–æ–ª–æ–≤–∫–∏ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏:** `Authorization: Bearer <token>` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ).
  - **–°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:** –ü—Ä–∏—Ö–æ–¥—è—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON `{"event": "<event_name>", "data": { ... }}`.
    - **–ü—Ä–∏–º–µ—Ä:** `{"event": "order_status_changed", "data": {"orderId": 123, "newStatus": "PREPARING"}}`
  - **–ó–∞—â–∏—Ç–∞:** –¢—Ä–µ–±—É–µ—Ç—Å—è –ª—é–±–æ–π –≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω (—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏–ª–∏ –≥–æ—Å—Ç—è).

---

## üåê Web API (–¥–ª—è –≥–æ—Å—Ç–µ–π)

### üö™ –í—Ö–æ–¥ –∏ –°–µ—Å—Å–∏—è

- **`GET /web/status/{tableId}`**
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ—Å—Ç–µ–≤–æ–π —Å–µ—Å—Å–∏–∏ –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ QR-–∫–æ–¥–∞.
  - **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:** `{tableId}` - ID —Å—Ç–æ–ª–∏–∫–∞.
  - **–û—Ç–≤–µ—Ç (200 OK):** `{ "token": "string", "restaurantId": "string" }`
  - **–ó–∞—â–∏—Ç–∞:** –ü—É–±–ª–∏—á–Ω—ã–π.

### üçΩÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ –ó–∞–∫–∞–∑

- **`GET /web/restaurants/{id}`**
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ.
  - **–ó–∞—â–∏—Ç–∞:** –¢—Ä–µ–±—É–µ—Ç—Å—è –≥–æ—Å—Ç–µ–≤–æ–π —Ç–æ–∫–µ–Ω.

- **`GET /web/menu`**
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ–Ω—é.
  - **–ó–∞—â–∏—Ç–∞:** –¢—Ä–µ–±—É–µ—Ç—Å—è –≥–æ—Å—Ç–µ–≤–æ–π —Ç–æ–∫–µ–Ω.

- **`POST /web/order`** (–ü—Ä–∏–º–µ—Ä, —Ç—Ä–µ–±—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è)
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ –≥–æ—Å—Ç–µ–º.
  - **–ó–∞—â–∏—Ç–∞:** –¢—Ä–µ–±—É–µ—Ç—Å—è –≥–æ—Å—Ç–µ–≤–æ–π —Ç–æ–∫–µ–Ω.

- **`POST /web/waiter_request`**
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –≤—ã–∑–æ–≤ –æ—Ñ–∏—Ü–∏–∞–Ω—Ç–∞.
  - **–ó–∞—â–∏—Ç–∞:** –¢—Ä–µ–±—É–µ—Ç—Å—è –≥–æ—Å—Ç–µ–≤–æ–π —Ç–æ–∫–µ–Ω.

---

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, –Ω–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–¥–µ—Å—å –∫–∞–∫ –ø—É–±–ª–∏—á–Ω—ã–µ, —Ç–µ–ø–µ—Ä—å —Ç—Ä–µ–±—É—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π JWT-—Ç–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞.*